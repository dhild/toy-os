TOS_BUILDSUBDIR = $(TOS_BUILDDIR)/include/kernel

include $(TOS_BASEMAKE)

OUTPUTS := interrupts.mac interrupts.h

all: $(OUTPUTS)

interrupts.mac: interrupts.in
	$(Q)echo 'Building $@'
	@echo ';; This file is automatically generated from $^.' > $@; \
	echo ';; DO NOT MODIFY IT DIRECTLY!' >> $@; \
	$(SED) -e '/\/\//d' -e 's/define/%define/g' interrupts.in >> $@;

interrupts.h: interrupts.in
	$(Q)echo 'Building $@'
	@echo '/* This file is automatically generated from $^. */' > $@; \
	echo '/* DO NOT MODIFY IT DIRECTLY! */' >> $@; \
	echo '#ifndef KERNEL_INTERRUPTS_H' >> $@; \
	echo '#define KERNEL_INTERRUPTS_H' >> $@; \
	$(SED) -e '/\/\//d' -e 's/define/#define/g' interrupts.in >> $@; \
	echo '#endif /* KERNEL_INTERRUPTS_H */' >> $@

clean:
	$(RM) -f $(OUTPUTS)
